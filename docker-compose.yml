version: '3.8'

services:
  fastapi-detect:
    build:
      context: ./app
      dockerfile: Dockerfile
    container_name: fastapi_detect
    restart: always
    environment:
      - PYTHONPATH=/app
      - CUDA_VISIBLE_DEVICES=5
    volumes:
      - ./app:/app
      - /home/ubuntu/model/:/home/ubuntu/model/
    expose:
      - "8000"
    networks:
      - dpg_default
    shm_size: '2gb'

networks:
  dpg_default:
    external: true
    driver: bridge
